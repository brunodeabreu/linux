<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>linux - 7&nbsp; Red Hat OpenShift Administration II: Operating a Production Kubernetes Cluster - DO280</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./OpenShift1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./OpenShift2.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Red Hat OpenShift Administration II: Operating a Production Kubernetes Cluster - DO280</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">linux</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Sysadmin1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Server Administrator I - RH124</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Sysadmin2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Server Administrator II - RH134</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Sysadmin3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Server Administrator III - RH294</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OpenShift1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Red Hat OpenShift I: Containers &amp; Kubernetes - DO180</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OpenShift2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Red Hat OpenShift Administration II: Operating a Production Kubernetes Cluster - DO280</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#describing-the-red-hat-openshift-container-plataform" id="toc-describing-the-red-hat-openshift-container-plataform" class="nav-link active" data-scroll-target="#describing-the-red-hat-openshift-container-plataform"><span class="header-section-number">7.1</span> Describing the Red Hat OpenShift Container Plataform</a>
  <ul class="collapse">
  <li><a href="#describing-openshift-container-platform" id="toc-describing-openshift-container-platform" class="nav-link" data-scroll-target="#describing-openshift-container-platform"><span class="header-section-number">7.1.1</span> Describing OpenShift Container Platform</a></li>
  <li><a href="#architecture-of-openshift" id="toc-architecture-of-openshift" class="nav-link" data-scroll-target="#architecture-of-openshift"><span class="header-section-number">7.1.2</span> Architecture of OpenShift</a></li>
  <li><a href="#cluster-operators" id="toc-cluster-operators" class="nav-link" data-scroll-target="#cluster-operators"><span class="header-section-number">7.1.3</span> Cluster Operators</a></li>
  </ul></li>
  <li><a href="#verifying-the-health-of-a-cluster" id="toc-verifying-the-health-of-a-cluster" class="nav-link" data-scroll-target="#verifying-the-health-of-a-cluster"><span class="header-section-number">7.2</span> Verifying the Health of a Cluster</a>
  <ul class="collapse">
  <li><a href="#intro-to-openshift-installtion-methods" id="toc-intro-to-openshift-installtion-methods" class="nav-link" data-scroll-target="#intro-to-openshift-installtion-methods"><span class="header-section-number">7.2.1</span> Intro to OpenShift Installtion Methods</a></li>
  <li><a href="#troubleshooting-openshit-cluster-and-applications" id="toc-troubleshooting-openshit-cluster-and-applications" class="nav-link" data-scroll-target="#troubleshooting-openshit-cluster-and-applications"><span class="header-section-number">7.2.2</span> Troubleshooting OpenShit Cluster and Applications</a></li>
  <li><a href="#introducing-openshift-dynamic-storage" id="toc-introducing-openshift-dynamic-storage" class="nav-link" data-scroll-target="#introducing-openshift-dynamic-storage"><span class="header-section-number">7.2.3</span> Introducing OpenShift Dynamic Storage</a></li>
  </ul></li>
  <li><a href="#configuring-authentication-and-authorization" id="toc-configuring-authentication-and-authorization" class="nav-link" data-scroll-target="#configuring-authentication-and-authorization"><span class="header-section-number">7.3</span> Configuring Authentication and Authorization</a>
  <ul class="collapse">
  <li><a href="#identity" id="toc-identity" class="nav-link" data-scroll-target="#identity"><span class="header-section-number">7.3.1</span> Identity</a></li>
  <li><a href="#configuring-the-htpasswd-identity-provider" id="toc-configuring-the-htpasswd-identity-provider" class="nav-link" data-scroll-target="#configuring-the-htpasswd-identity-provider"><span class="header-section-number">7.3.2</span> Configuring the HTPasswd Identity Provider</a></li>
  </ul></li>
  <li><a href="#configuring-application-security" id="toc-configuring-application-security" class="nav-link" data-scroll-target="#configuring-application-security"><span class="header-section-number">7.4</span> Configuring Application Security</a>
  <ul class="collapse">
  <li><a href="#managing-sensitive-information-with-secrets" id="toc-managing-sensitive-information-with-secrets" class="nav-link" data-scroll-target="#managing-sensitive-information-with-secrets"><span class="header-section-number">7.4.1</span> Managing Sensitive Information with secrets</a></li>
  <li><a href="#controlling-application-permissions-with-security-contect-contrainst" id="toc-controlling-application-permissions-with-security-contect-contrainst" class="nav-link" data-scroll-target="#controlling-application-permissions-with-security-contect-contrainst"><span class="header-section-number">7.4.2</span> Controlling Application Permissions with Security Contect Contrainst</a></li>
  </ul></li>
  <li><a href="#configuring-openshift-networking-for-applications" id="toc-configuring-openshift-networking-for-applications" class="nav-link" data-scroll-target="#configuring-openshift-networking-for-applications"><span class="header-section-number">7.5</span> Configuring OpenShift Networking For Applications</a>
  <ul class="collapse">
  <li><a href="#openshift-software-defined-networking" id="toc-openshift-software-defined-networking" class="nav-link" data-scroll-target="#openshift-software-defined-networking"><span class="header-section-number">7.5.1</span> OpenShift Software-defined Networking</a></li>
  <li><a href="#exposing-applications-for-external-access" id="toc-exposing-applications-for-external-access" class="nav-link" data-scroll-target="#exposing-applications-for-external-access"><span class="header-section-number">7.5.2</span> Exposing Applications for External Access</a></li>
  <li><a href="#configuring-network-policies" id="toc-configuring-network-policies" class="nav-link" data-scroll-target="#configuring-network-policies"><span class="header-section-number">7.5.3</span> Configuring Network Policies</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Red Hat OpenShift Administration II: Operating a Production Kubernetes Cluster - DO280</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="describing-the-red-hat-openshift-container-plataform" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="describing-the-red-hat-openshift-container-plataform"><span class="header-section-number">7.1</span> Describing the Red Hat OpenShift Container Plataform</h2>
<section id="describing-openshift-container-platform" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="describing-openshift-container-platform"><span class="header-section-number">7.1.1</span> Describing OpenShift Container Platform</h3>
<p>RHOCP is based on Kubernetes and allow manage container at scale, a container orchestrator platform manages a cluster service that runs multiple containerized applications .</p>
<p>Solutions :</p>
<ul>
<li><p><strong>Red Hat OpenShift Container Platform</strong> : <strong>Enterprise-ready</strong> Kubernetes environment for building, deploying and managing container-based applications on any public or private data center. Red Hat decide when update to newer releases and which addition component to enable</p></li>
<li><p><strong>Red Hat OpenShift Dedicated</strong> : Managed OpenShift environment in a <strong>public cloud</strong>, AWS, GCP, Azure, or IBM Cloud, all features of RHOCP, however <strong>Red Hat manage the cluster</strong>, we have some control of decisions as when to update to a newer release or to install add-ons.</p></li>
<li><p><strong>Red Hat OpenShift Online</strong> : Public container platform <strong>shared</strong> across multiple customers, Red Hat manages the cluster life cycle.</p></li>
<li><p><strong>Red Hat OpenShift Kubernetes Engine</strong> : <strong>Subset</strong> of the features present in <em>Red Hat OpenShift RCOP</em>, such as coreOS, CRI-O engine, web console, etc</p></li>
<li><p><strong>Red Hat Code Ready Container</strong> : <strong>Minimal</strong> installation of OpenShift that we can run on a laptop to <strong>development and experimentation</strong>.</p></li>
</ul>
<p>Below the services and features of Openshift</p>
<div class="cell" data-fig.margin="true">
<div class="cell-output-display">
<p><img src="img/openShift_features.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
<p><br></p>
<p><strong>Introduction of OpenShift features</strong></p>
<p>Comparing OpenShift Container Platform vs OpenShift Kubernetes Engine:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/openShift_features_comparison.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
<p><strong>Features :</strong></p>
<ul>
<li><strong>High Availability</strong> : <strong>etc</strong> cluster store the state of the OpenShift Cluster and Applications</li>
<li><strong>Lightweight OS</strong> : <strong>CoreOS</strong> focuses on agility, portability and security</li>
<li><strong>Load Balancing</strong> : <em>External</em> via API, <em>HAProxy</em> load balance for external app and <em>internal</em> load balance</li>
<li><strong>Automating Scaling</strong> : can adapt to increased application traffic in real time by automatically starting new containers and terminate when the load decrease.</li>
<li><strong>Logging and Monitoring</strong> : Advanced monitoring solution based on Prometheus, also advanced logging solution based on ElasticSearch.</li>
<li><strong>Service Discovery</strong> : Internal DNS, application can rely on friendly names to find other app and services</li>
<li><strong>Storage</strong> : Allow automatic provisioning of storage on popular cloud providers and visualization platforms</li>
<li><strong>Application Management</strong> : Automate the development and deploy, automatic build containers based on source code using Source-To-Image (<em>S2I</em>) solution.</li>
<li><strong>Cluster Extensibility</strong> : Rely on standard extension from kubernetes, Openshift packages these extensions as operators for ease of installation, update, and management. Also include Operator Lifecycle Manager (<em>OLM</em>), which facilitates the discovery, installation, and update of applications and infrastructure components packaged as operators</li>
</ul>
<p>OpenShift also includes the <strong>Operator Lifecycle Manager (OLM)</strong> which facilitates the discovery, installation, and update of applications and infrastructure components packaged as operators</p>
</section>
<section id="architecture-of-openshift" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="architecture-of-openshift"><span class="header-section-number">7.1.2</span> Architecture of OpenShift</h3>
<p>OpenShift architecture is based on <strong>declarative</strong> the nature of kubernetes. In a declarative architecture, you change the state of the system and the system updates itself to comply with the new state.</p>
<ul>
<li><p>Kubernetes cluster consists of a set of nodes that run the <code>kubelet</code> system service and a container engine.</p></li>
<li><p>OpenShift runs exclusively the CRI-O container engine. Some nodes are control plane nodes that run the REST API, the <code>etcd</code> database, and the platform controllers</p></li>
</ul>
<p>OpenShift is a Kubernetes distribution that provides many of these components already integrated and configured, and managed by operators. OpenShift also provides preinstalled applications, such as a container image registry and a web console, managed by operators.</p>
</section>
<section id="cluster-operators" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="cluster-operators"><span class="header-section-number">7.1.3</span> Cluster Operators</h3>
<blockquote class="blockquote">
<p>Kubernetes operators are applications that invoke the Kubernetes API to manage Kubernetes resources.</p>
</blockquote>
<ul>
<li>Custom resources <em>(CR)</em> : store settings and configurations</li>
<li>Custom resource definition <em>(CRD)</em> : the <strong>syntax</strong> of a custom resource is defined by a custom resource definition</li>
</ul>
<p>Most operators manage another application; for example, an operator that manages a database server.</p>
<p>The purpose of an operator is usually to automate tasks.</p>
<p><br></p>
<p><strong>Operator Framework</strong></p>
<ul>
<li><p><strong>Operator Software Development Kit (Operator SDK)</strong> : Golang library and source code. Also provide container image and ansible playbook examples.</p></li>
<li><p><strong>Operator Life Cycle Manager (OLM)</strong> : Application that manages the deployment, resource utilization, updates and deletion of operators. The OLM itself is an operator that comes preinstalled with OpenShift.</p></li>
</ul>
<p><br></p>
<p><strong>OperatorHub</strong></p>
<p>OperatorHub provides a web interface to discover and publish operators that follow the Operator Framework standards.</p>
<ul>
<li><p>Red Hat Marketplace is a platform that allow access a curated set of enterprise operators that can be deployed on OpenShift or a kubernetes cluster</p></li>
<li><p>OpenShift Cluster Operators : regular operators except that they are not managed by the OLM, they are managed by OpenShift Cluster Version Operators, also called as first level operator.</p></li>
</ul>
</section>
</section>
<section id="verifying-the-health-of-a-cluster" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="verifying-the-health-of-a-cluster"><span class="header-section-number">7.2</span> Verifying the Health of a Cluster</h2>
<section id="intro-to-openshift-installtion-methods" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="intro-to-openshift-installtion-methods"><span class="header-section-number">7.2.1</span> Intro to OpenShift Installtion Methods</h3>
<p><strong>Full-stack Automation</strong> : <strong>Installe</strong> provisions all compute, storage and network, on <strong>cloud or virtualization</strong></p>
<p><strong>Pre-existing Infrastructure</strong> : we can configure a set of compute, storage and network resources, can be configured on <strong>bare-metal, cloud or virtualizations</strong> providers</p>
<p><strong>Deploy process</strong></p>
<p>Install stages that results in a fully running OpenShift control plane :</p>
<ol type="1">
<li><p>The <strong>bootstrap machine boots</strong> and starts hosting the remote resources for booting the control plane machine, <em>“like a repo”</em></p></li>
<li><p>Control plane machine <strong>fetch the remote resources</strong> from bootstrap machine</p></li>
<li><p>Control plane form an <strong>Etcd</strong> cluster</p></li>
<li><p>Bootstrap machine starts a temp kubernetes control plane</p></li>
<li><p>The temp control plane <strong>schedule the control plane</strong> to the control plane machines</p></li>
<li><p>The temp control plane shuts down</p></li>
<li><p>Bootstraps injects components to OpenShift into control plane</p></li>
<li><p>Installer tears down the bootstrap machine</p></li>
</ol>
<p>We can customize the installer by adding custom storage class, change custom resources, adding new operators and defining new machine sets.</p>
</section>
<section id="troubleshooting-openshit-cluster-and-applications" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="troubleshooting-openshit-cluster-and-applications"><span class="header-section-number">7.2.2</span> Troubleshooting OpenShit Cluster and Applications</h3>
<p>Commands :</p>
<ul>
<li><p><code>oc get nodes</code> : Status of each node</p></li>
<li><p><code>oc adm top nodes</code> : CPU and Memory of each node</p></li>
<li><p><code>oc describe node &lt;my_node-name&gt;</code> : Resources available and used</p></li>
<li><p><code>pc get clusterversion</code> : version of cluster</p></li>
<li><p><code>oc describe clusterversion</code> : mode details about cluster status</p></li>
<li><p><code>oc get clusteroperators</code> : list of all cluster operators</p></li>
<li><p><code>oc adm node-logs -u &lt;unit&gt; &lt;my-node-name&gt;</code> : view logs</p>
<ul>
<li>Unit can be : crio, kubelet, etc</li>
</ul></li>
<li><p><code>oc adm node-logs &gt;my-node-name&gt;</code> : display all journal logs of a node</p></li>
<li><p><code>oc logs &lt;my-pode-name&gt;</code> show de logs of pod</p></li>
<li><p><code>oc logs &lt;my-pod-name&gt; -c &lt;my-container-name&gt;</code> : show logs of container</p></li>
<li><p>Debug</p></li>
</ul>
<pre><code>oc debug node/&lt;my-node-name&gt;
chroot /host
systemctl is-active kubelet


oc debug node/&lt;my-node-name&gt;
chroot /host
crictl ps

</code></pre>
<ul>
<li>Debug as root</li>
</ul>
<pre><code>[user@host ~]$ oc debug deployment/my-deployment-name --as-root</code></pre>
<ul>
<li><p>Changing a running container</p>
<ul>
<li><code>oc rsh &lt;my-pod-name&gt;</code> open shell inside the a pod</li>
<li><code>oc cp /local/path my-pod-name:/conatiner/path</code> : copy files</li>
<li><code>oc port-forward my-pod-name local-port:remote-port</code> : create a tcp tunel</li>
</ul></li>
<li><p><code>oc get pod --level 6</code> : Show logs on different levels</p></li>
<li><p><code>oc whoami -t</code> : Make a token that the oc command use</p></li>
</ul>
</section>
<section id="introducing-openshift-dynamic-storage" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="introducing-openshift-dynamic-storage"><span class="header-section-number">7.2.3</span> Introducing OpenShift Dynamic Storage</h3>
<p>Container offers two main ways of maitaining persistent storage, using volumes and bind mounts.</p>
<ul>
<li>Volumes are managed manuall by admin or dynamically via storage class</li>
<li>Devs can mount a local directory into a container using bind mount</li>
</ul>
<p>OpenShift use <strong>Kubernetes</strong> persistent volume framework to manage persistent storage <strong>dynamic or static</strong>.</p>
<p>A <strong>persistent volume claim (PVC)</strong>, where appl going to request a type of storage, belongs to a specific project. To create a PVC, you must specify the access mode and size, among other options. Once created, a PVC cannot be shared between projects. Developers use a PVC to access a <strong>persistent volume (PV)</strong>.</p>
<ul>
<li>Verify the Dynamic Provisioned storage</li>
</ul>
<pre><code>[user@host ~]$ oc get storageclass</code></pre>
<ul>
<li>Deploying Dynamically Provisioned Storage, to add volume to an application create a <strong>PersistentVolumeClaim</strong> resource and add it to application as a volume</li>
</ul>
<pre><code>[user@host ~]$ oc set volumes deployment/example-application \
--add --name example-storage --type pvc --claim-class nfs-storage \
--claim-mode rwo --claim-size 15Gi --mount-path /var/lib/example-app \
--claim-name example-storage</code></pre>
<ul>
<li>Deleting Persistent Volume Claims</li>
</ul>
<pre><code>[user@host ~]$ oc delete pvc/example-pvc-storage</code></pre>
</section>
</section>
<section id="configuring-authentication-and-authorization" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="configuring-authentication-and-authorization"><span class="header-section-number">7.3</span> Configuring Authentication and Authorization</h2>
<section id="identity" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="identity"><span class="header-section-number">7.3.1</span> Identity</h3>
<ul>
<li><strong>User</strong> : Interact with the API server</li>
<li><strong>Identity</strong> : keeps a record of successful authentication attempts from a specific user and identity provider. Only a single user resource is associated with an identity resource.</li>
<li><strong>Service Account</strong> : enable you to control API access without the need to borrow a regular user’s credentials</li>
<li><strong>Group</strong> : set of users</li>
<li><strong>Role</strong> : defines a set of permissions that enables a user to perform API operations over one or more resources</li>
</ul>
<p><br></p>
<p><strong>The authentication and autorization security layers</strong></p>
<p>The authentication layer authenticates the userusing <em>(OAuth Access tokens or X.509 Client Certification)</em>. Upon successful authentication, the authorization layer decides to either honor or reject the API request. The authorization layer use RBAC policies.</p>
<ul>
<li><p>Authentication Operator : OpenShift OAuth server can be configured to use many identity providers.</p>
<ul>
<li><strong>HTPasswd</strong> : Validate user and password against a secret using <code>htpasswd</code></li>
<li><strong>Keystone</strong> : Enables shared authentication with an OpenStack Keystone v3 server.</li>
<li><strong>LDAP</strong> : Configure LDAP`identity provider to validate against an LDAPv3 server</li>
<li><strong>GitHub or GitHub Enterprise</strong> : use OAuth github authentication</li>
<li><strong>OpenID Connect</strong> : Use Code Flow integrates with an OpenID connect</li>
</ul></li>
<li><p>During install OpenShift create a <strong>kubeconfig</strong> file that contains specific details and parameter to be used by CLI</p></li>
</ul>
<pre><code>INFO Run 'export KUBECONFIG=root/auth/kubeconfig' to manage the cluster with 'oc'.</code></pre>
<ul>
<li>To use <strong>kubeconfig</strong> file</li>
</ul>
<pre><code>[user@host ~]$ export KUBECONFIG=/home/user/auth/kubeconfig
[user@host ~]$ oc get nodes

# or

[user@host ~]$ oc --kubeconfig /home/user/auth/kubeconfig get nodes
</code></pre>
</section>
<section id="configuring-the-htpasswd-identity-provider" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="configuring-the-htpasswd-identity-provider"><span class="header-section-number">7.3.2</span> Configuring the HTPasswd Identity Provider</h3>
<p>Need to update the OAuth custom resource add the .spec.identityProviders array :</p>
<pre><code>apiVersion: config.openshift.io/v1
kind: OAuth
metadata:
  name: cluster
spec:
  identityProviders:
  - name: my_htpasswd_provider
    mappingMethod: claim
    type: HTPasswd
    htpasswd:
      fileData:
        name: htpasswd-secret</code></pre>
<ul>
<li>To export the current OAuth cluster resource in YAML format</li>
</ul>
<pre><code>[user@host ~]$ oc get oauth cluster -o yaml &gt; oauth.yaml</code></pre>
<ul>
<li>Open the file edit and replace on cluster</li>
</ul>
<pre><code>[user@host ~]$ oc replace -f oauth.yaml</code></pre>
<p><br></p>
<p><strong>Managing Users with the HTPasswd Identity Provider</strong></p>
<ul>
<li>Create an HTPasswd File</li>
</ul>
<pre><code>[user@host ~]$ htpasswd -c -B -b /tmp/htpasswd student redhat123</code></pre>
<ul>
<li>Add or update credentials</li>
</ul>
<pre><code>[user@host ~]$ htpasswd -b /tmp/htpasswd student redhat1234</code></pre>
<ul>
<li>Create the HTPasswd Secret</li>
</ul>
<pre><code>[user@host ~]$ oc create secret generic htpasswd-secret --from-file htpasswd=/tmp/htpasswd -n openshift-config</code></pre>
<ul>
<li>Extracting Secret Data</li>
</ul>
<pre><code>oc extract secret/htpasswd-secret -n openshift-config --to /tmp/ --confirm /tmp/htpasswd</code></pre>
<ul>
<li>Updating the HTPasswd Secret</li>
</ul>
<pre><code>oc set data secret/htpasswd-secret --from-file htpasswd=/tmp/htpasswd -n openshift-config</code></pre>
<ul>
<li>Watch the redeploy pods</li>
</ul>
<pre><code>[user@host ~]$ watch oc get pods -n openshift-authentication</code></pre>
<p><br></p>
<p><strong>Deleting Users and Identities</strong></p>
<ul>
<li>To delete the user from htpasswd</li>
</ul>
<pre><code>[user@host ~]$ htpasswd -D /tmp/htpasswd manager</code></pre>
<ul>
<li>Update the secret to remove all remnants of the user</li>
</ul>
<pre><code>oc set data secret/htpasswd-secret  --from-file htpasswd=/tmp/htpasswd -n openshift-config</code></pre>
<ul>
<li>To remove the user resource</li>
</ul>
<pre><code>[user@host ~]$ oc delete user manager</code></pre>
<ul>
<li>To delete identity resource</li>
</ul>
<pre><code># check
[user@host ~]$ oc get identities | grep manager

# to delete
[user@host ~]$ oc delete identity my_htpasswd_provider:manager</code></pre>
<p><br></p>
<p><strong>Assigning Administrative Privileges</strong></p>
<pre><code># assigns the cluster-admin role to the student user.
[user@host ~]$ oc adm policy add-cluster-role-to-user cluster-admin student</code></pre>
</section>
</section>
<section id="configuring-application-security" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="configuring-application-security"><span class="header-section-number">7.4</span> Configuring Application Security</h2>
<section id="managing-sensitive-information-with-secrets" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="managing-sensitive-information-with-secrets"><span class="header-section-number">7.4.1</span> Managing Sensitive Information with secrets</h3>
<p>Kubernetes and OpenShift use secret resources to hold sensitive information :</p>
<ul>
<li>Password</li>
<li>Sensitive configuration files</li>
<li>Credentials to an external resource, such as SSH Key or OAuth token</li>
</ul>
<p>Secrete is Base64-encoded, not stored in plain text, we can encrupt the Etcd and that encrypt secrets, config maps, routes, OAuth.</p>
<p><br></p>
<p><strong>Featuers of Secrets</strong></p>
<ul>
<li>Can be shared within project namespace</li>
<li>Administrators can create and manage secrets that other team cdan reference in thei deploy config</li>
<li>Secret data is injected into pods</li>
<li>After a secret value changes we must create a new pods to inject the new data</li>
<li>OpenShift exposes sensitive data to a pod as environment variable</li>
</ul>
<p><br></p>
<p><strong>Use cases for secrets</strong></p>
<ul>
<li><p>Credentials</p>
<ul>
<li>If an application expects to read sensitive information from a file, then you mount the secret as a data volume to the pod.</li>
<li>Some applications use environment variables to read configuration and sensitive data. You can link secret variables to pod environment variables in a deployment configuration.</li>
</ul></li>
<li><p>TLS and Key Pairs <em>Used to to secure communication to a pod</em></p>
<ul>
<li>Developers can mount the secret as a volume and create a pass through route to the application.</li>
</ul></li>
</ul>
<p><strong>Creating Secret</strong></p>
<ul>
<li>Using Key-value</li>
</ul>
<pre><code>[user@host ~]$ oc create secret generic secret_name --from-literal key1=secret1 --from-literal key2=secret2</code></pre>
<ul>
<li>Using Key names</li>
</ul>
<pre><code>[user@host ~]$ oc create secret generic ssh-keys --from-file id_rsa=/path-to/id_rsa --from-file id_rsa.pub=/path-to/id_rsa.pub</code></pre>
<ul>
<li>Create a TLS secret</li>
</ul>
<pre><code>[user@host ~]$ oc create secret tls secret-tls --cert /path-to-certificate --key /path-to-key</code></pre>
<p><strong>Exposing Secrets to Pods</strong></p>
<ol type="1">
<li>Create the secret</li>
</ol>
<pre><code>[user@host ~]$ oc create secret generic demo-secret --from-literal user=demo-user --from-literal root_password=zT1KTgk</code></pre>
<ol start="2" type="1">
<li>Modify the env variable section of the deploy config</li>
</ol>
<pre><code>env:
  - name: MYSQL_ROOT_PASSWORD
    valueFrom:
      secretKeyRef:
          name: demo-secret
          key: root_password</code></pre>
<ol start="3" type="1">
<li>Set application environment variables from either secrets or configuration maps.</li>
</ol>
<pre><code>[user@host ~]$ oc set env deployment/demo --from secret/demo-secret --prefix MYSQL_</code></pre>
<ol start="4" type="1">
<li>A secret can be mounted</li>
</ol>
<pre><code>[user@host ~]$ oc set volume deployment/demo --add --type secret --secret-name demo-secret --mount-path /app-secrets</code></pre>
<p><br></p>
<p><strong>Configuration Map</strong></p>
<p>Similar to secrets, configuration maps decouple configuration information from container images. Unlike secrets, the information contained in configuration maps does not require protection</p>
<pre><code>[user@host ~]$ oc create configmap my-config --from-literal key1=config1 --from-literal key2=config2</code></pre>
<p><br></p>
<p><strong>Updating Secrets and Configuration Maps</strong></p>
<ol type="1">
<li>Extract the last data</li>
</ol>
<pre><code>[user@host ~]$ oc extract secret/htpasswd-ppklq -n openshift-config --to /tmp/ --confirm</code></pre>
<ol start="2" type="1">
<li><p>Update and save the files</p></li>
<li><p>Use <code>oc set data</code> to update</p></li>
</ol>
<pre><code>[user@host ~]$ oc set data secret/htpasswd-ppklq -n openshift-config --from-file /tmp/htpasswd</code></pre>
</section>
<section id="controlling-application-permissions-with-security-contect-contrainst" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="controlling-application-permissions-with-security-contect-contrainst"><span class="header-section-number">7.4.2</span> Controlling Application Permissions with Security Contect Contrainst</h3>
<p><strong>Security Context Constraints (SCCs)</strong> : a security mechanism that restricts access to resources, but not to operations in OpenShift.</p>
<ul>
<li>Check the list of SCCs</li>
</ul>
<pre><code>oc get scc</code></pre>
<ul>
<li>Get additional info about an SCC</li>
</ul>
<pre><code>[user@host ~]$ oc describe scc anyuid</code></pre>
<ul>
<li>View the security contect constraint that pod uses</li>
</ul>
<pre><code>[user@host ~]$ oc describe pod console-5df4fcbb47-67c52 -n openshift-console | grep scc</code></pre>
<ul>
<li>Use the <code>scc-subject-review</code> subcommand to list all the security context constraints that can overcome the limitations of a container:</li>
</ul>
<pre><code>[user@host ~]$ oc get pod podname -o yaml | oc adm policy scc-subject-review -f -</code></pre>
<ul>
<li>To change the container to run using a different SCC, you must create a service account bound to a pod.</li>
</ul>
<pre><code>[user@host ~]$ oc create serviceaccount service-account-name</code></pre>
<ul>
<li>Associate the service account with an SCC</li>
</ul>
<pre><code>[user@host ~]$ oc adm policy add-scc-to-user SCC -z service-account</code></pre>
<ul>
<li>Modify an existing deployment or deploy config</li>
</ul>
<pre><code>[user@host ~]$ oc set serviceaccount deployment/deployment-name service-account-name</code></pre>
</section>
</section>
<section id="configuring-openshift-networking-for-applications" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="configuring-openshift-networking-for-applications"><span class="header-section-number">7.5</span> Configuring OpenShift Networking For Applications</h2>
<section id="openshift-software-defined-networking" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="openshift-software-defined-networking"><span class="header-section-number">7.5.1</span> OpenShift Software-defined Networking</h3>
<ul>
<li>SDN <em>(software-defined network)</em> is a networking model that allows you to manage network services through the abstraction of several networking layers.
<ul>
<li>SDN use CNI plug-ins that allows containers inside pods share network resources</li>
<li>Common CNI plug-ins : <strong>OpenShift SDN</strong>, <strong>OVN-Kubernetes</strong> and <strong>kuryr</strong></li>
</ul></li>
<li>OpenShift implmenets the SDN to manage networking infrastructure of the cluster and user applications</li>
</ul>
<p>We can :</p>
<ul>
<li>Manage network traffic and decice how to expose the applications</li>
<li>Manage communications between containers that run in the same projects</li>
<li>Manage communication between pods</li>
<li>Manage network from pod to a service</li>
<li>Manage network from an external network to a service, or from containers to external networks</li>
</ul>
<p><br></p>
<p><strong>Using Services for accessing pods</strong></p>
<p>Services rely on selectors (labels) that indicate which pods receive the traffic through the service. Each pod matching these selectors is added to the service resource as an endpoint. As pods are created and killed, the service automatically updates the endpoints.</p>
<p>OpenShift uses two subnets (onde for <strong>pods</strong> and another one for <strong>services</strong>). The traffic is forwarded in a transparent way to the pods; an agent manages routing rules to route traffic to the pods that match the selectors.</p>
<p><br></p>
<p><strong>DNS Operator</strong></p>
<ul>
<li><p>The DNS operator deploys and runs a DNS server managed by CoreDNS.</p></li>
<li><p>The DNS operator provides DNS name resolution between pods</p></li>
<li><p>To check</p></li>
</ul>
<pre><code>[user@demo ~]$ oc describe dns.operator/default</code></pre>
<p><br></p>
<p><strong>Cluster Network Operator</strong></p>
<p>OpenShift Container Platform uses the Cluster Network Operator for managing the SDN</p>
<ul>
<li>To consult the SDN configuration which is managed by the <code>Network.config.openshift.io</code></li>
</ul>
<pre><code>[user@demo ~]$ oc get network/cluster -o yaml</code></pre>
</section>
<section id="exposing-applications-for-external-access" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="exposing-applications-for-external-access"><span class="header-section-number">7.5.2</span> Exposing Applications for External Access</h3>
<p><strong>Accessing Application from External Networks</strong></p>
<ul>
<li><p>Can use :</p>
<ul>
<li>HTTP</li>
<li>HTTPS</li>
<li>TCP</li>
<li>non-TCP</li>
<li>Others using <strong>Ingress</strong> and <strong>Route</strong></li>
</ul></li>
</ul>
<p><strong>OpenShift Route</strong> allow expose applicationn to external network</p>
<p><br></p>
<p><strong>Describing Methods for Managing Ingress Traffic</strong></p>
<ul>
<li>OpenShift implements the Ingress Controller with a shared router service that runs as a pod inside the cluster.</li>
</ul>
<p><br></p>
<p><strong>Route</strong> :</p>
<ul>
<li>Provide ingress traffic to services in the cluster</li>
<li>Provide features that may not be supported by Kubernetes ingress such as TLS re-encryption, TLS passthrough and split traffic for blue-green deployments</li>
</ul>
<p><br></p>
<p><strong>Ingress</strong> :</p>
<ul>
<li>A Kubernetes resource that provides some of the same features as routes</li>
<li>Accept external requests and proxy them based on the route.</li>
<li>Only allow HTTP, HTTPS and server name identification SNI and TLS with SNI</li>
</ul>
<p><br></p>
<p><em>Others</em></p>
<p><strong>External load balancer</strong> : A load balancer instructs OpenShift to interact with the cloud provider in which the cluster is running to provision a load balancer.</p>
<p><strong>Service external IP</strong> : This method instructs OpenShift to set NAT rules to redirect traffic from one of the cluster IPs to the container</p>
<p><strong>NodePort</strong> : With this method, OpenShift exposes a service on a static port on the node IP address. You must ensure that the external IP addresses are properly routed to the nodes.</p>
<p><br></p>
<p><strong>Creating Routes</strong></p>
<pre><code>[user@host ~]$ oc expose service api-frontend --hostname api.apps.acme.com</code></pre>
<p><br></p>
<p><strong>Securing Routes</strong></p>
<ul>
<li><p>Edge</p></li>
<li><p>Passthrough</p></li>
<li><p>Re-encryption</p></li>
<li><p>how to create a secure edge route with TLS certificate</p></li>
</ul>
<pre><code>[user@host ~]$ oc create route edge --service api-frontend --hostname api.apps.acme.com --key api.key --cert api.crt</code></pre>
</section>
<section id="configuring-network-policies" class="level3" data-number="7.5.3">
<h3 data-number="7.5.3" class="anchored" data-anchor-id="configuring-network-policies"><span class="header-section-number">7.5.3</span> Configuring Network Policies</h3>
<blockquote class="blockquote">
<p>Network policies allow you to configure isolation policies for individual pods</p>
</blockquote>
<p>To manage network communication between two namespaces, assign a label to the namespace that needs access to another namespace. The following command assigns the name=network-1 label to the network-1 namespace:</p>
<pre><code>[user@host ~]$ oc label namespace network-1 name=network-1</code></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./OpenShift1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Red Hat OpenShift I: Containers &amp; Kubernetes - DO180</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>